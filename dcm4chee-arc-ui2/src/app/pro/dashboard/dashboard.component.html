<div class="dashboard" *ngIf="elasticSearchIsRunning" >
    <div class="dashboard_content">
        <h2 class="dashboard_block">Counts <span class="range" *ngIf="rangeDay.from && rangeDay.to">{{rangeDay.from |date:'yyyy.MM.dd HH:mm'}} - {{rangeDay.to|date:'yyyy.MM.dd HH:mm'}}</span></h2>
        <div class="dashboard_module">
            <div class="count_block dashboard_block">
                <div class="count"><span class="glyphicon glyphicon-save"></span>{{counts.studieStored}}</div>
                <div class="text">Studies Stored Count</div>
            </div>
          <div class="count_block dashboard_block">
              <!--<div class="icon"><span class="glyphicon glyphicon-search"></span></div>-->
              <div class="count"><span class="glyphicon glyphicon-search"></span>{{counts.querie}}</div>
              <div class="text">Queries Count</div>
          </div>
          <div class="count_block dashboard_block">
              <!--<div class="icon"><span class="glyphicon glyphicon-save"></span></div>-->
              <div class="count"><span class="glyphicon glyphicon-open"></span>{{counts.retrieve}}</div>
              <div class="text">Retrieves Count</div>
          </div>

          <div class="count_block dashboard_block pointer" (click)="showErrors()">
              <!--<div class="icon"><span class="glyphicon glyphicon-warning-sign"></span></div>-->
              <div class="count" [ngClass]="{'error':(counts.errors != '-' && counts.errors !='0')}"><span class="glyphicon glyphicon-warning-sign"></span>{{counts.errors}}</div>
              <div class="text">Audit Errors</div>
          </div>
          <div class="count_block dashboard_block pointer" (click)="showApplicationErrors()">
              <!--<div class="icon"><span class="glyphicon glyphicon-exclamation-sign"></span></div>-->
              <div class="count" [ngClass]="{'error':(counts.wildflError != '-' && counts.wildflError !='0')}"><span class="glyphicon glyphicon-exclamation-sign"></span>{{counts.wildflError}}</div>
              <div class="text">Application Errors</div>
          </div>
        </div>
    </div>
    <div class="dashboard_content" id="auditevents">
        <h2 class="dashboard_block">Audit Events
            <input type="text" [(ngModel)]="searchlist" placeholder="Search...">
            <span class="range" *ngIf="rangeDay.from && rangeDay.to">{{rangeDay.from |date:'yyyy.MM.dd HH:mm'}} - {{rangeDay.to|date:'yyyy.MM.dd HH:mm'}}</span>
        </h2>
        <div class="dashboard_module" >
            <div class="dashboard_table dashboard_block">
                <div class="no_data_table blue_color" *ngIf="!auditEvents"><i class="fa fa-circle-o-notch fa-spin"></i></div>
                <div class="no_data_table blue_color" *ngIf="auditEvents && auditEvents.length == 0">No data!</div>
                <div class="table_content" *ngIf="auditEvents && auditEvents.length > 0">
                    <table class="table table-bordered table-condensed">
                        <thead>
                        <tr>
                            <th></th>
                            <th>Time</th>
                            <th>AuditSourceID</th>
                            <th>EventID</th>
                            <th>EventActionCode</th>
                            <th>Patient ParticipantObjectName</th>
                            <th>Study ParticipantObjectID</th>
                            <th>AccessionNumber</th>
                            <th>Source UserID</th>
                            <th>Requestor UserID</th>
                            <th>EventOutcomeIndicator</th>
                        </tr>
                        </thead>
                        <tbody>
                        <ng-container *ngFor="let item of auditEvents | search:searchlist | slice:moreAudit.start:moreAudit.limit">
                            <tr (click)="detailView(item)">
                                <td class="pointer"><span class="glyphicon glyphicon-th-list"></span></td>
                                <td>{{item.Time | date:'yyyy.MM.dd HH:mm:ss'}}</td>
                                <td tooltip="{{item.AuditSourceID}}">{{item.AuditSourceID | trim:14}}</td>
                                <td tooltip="{{item.EventID}}">{{item.EventID | trim:20}}</td>
                                <td>{{item.ActionCode}}</td>
                                <td tooltip="{{item.Patient}}">{{item.Patient | trim:20}}</td>
                                <td tooltip="{{item.Study}}">{{item.Study |trim:40}}</td>
                                <td tooltip="{{item.AccessionNumber}}">{{item.AccessionNumber|trim:15}}</td>
                                <td tooltip="{{item.userId}}">{{item.userId |trim:15}}</td>
                                <td>{{item.requestorId}}</td>
                                <td>{{item.EventOutcomeIndicator.text}}</td>
                            </tr>
                            <tr *ngIf="item.showDetail">
                                <td colspan="11">
                                    <table class="table table-bordered table-condensed subtable" width="100%">
                                        <tr *ngFor="let objectKeys of Object.keys(item.wholeObject)">
                                            <td>{{objectKeys}}</td>
                                            <td>{{item.wholeObject[objectKeys]}}</td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </ng-container>
                        </tbody>
                    </table>
                </div>
                <button class="load_more" *ngIf="auditEvents && moreAudit.limit <= auditEvents.length" (click)="loadMoreAudit()"><i *ngIf="moreAudit.loaderActive" class="fa fa-spinner fa-spin fa-3x fa-fw"></i>More</button>
            </div>
        </div>
    </div>
</div>
<div class="dashboard statistics_content no_data" *ngIf="!elasticSearchIsRunning">
    <h3 class="text-center error">Unable to connect to Elasticsearch!</h3>
</div>