<div class="vex vex-theme-os diff">
    <div class="vex-dialog-form">
        <h5>{{titleLabel}}
            <span class="pull-right">{{index+1}}/{{studies.length}}</span></h5>
        <div class="diff_main_content">
            <div class="first_diff table_block" [ngClass]="{selected: (selectedVersion === 'FIRST' && groupName != 'missing'),missing_mode: groupName === 'missing'}">
                <div class="header">
                    <h3>{{aet1}}</h3>
                </div>
                <div class="diff_content first_table" (mouseenter)="setActiveTable('FIRST')" (mouseleave)="clearActiveTable()">
                    <!--{{currentStudy.primary | json}}-->
                    <table>
                        <tr *ngFor="let primaryKey of currentStudyIndex" [ngClass]="{diff_line: (_.hasIn(currentStudy,['primary',primaryKey,'diff']) && currentStudy.primary[primaryKey].diff) , active:activeTr === primaryKey}" (mouseenter)="activateTr(primaryKey)" (mouseleave)="clearTr()">
                            <td>{{currentStudy["level"][primaryKey]}} {{DCM4CHE.elementName.forTag(primaryKey,privateCreator(primaryKey))}}</td>
                            <td>{{primaryKey}}</td>
                            <td>
                                <ng-container *ngIf="_.hasIn(currentStudy.primary,[primaryKey,'object','Value',0]) && !_.hasIn(currentStudy.primary,[primaryKey,'object','Value',0,'Alphabetic']) && !(_.isEmpty(currentStudy.primary[primaryKey].object.Value[0]) && !_.isNumber(currentStudy.primary[primaryKey].object.Value[0]))">{{currentStudy.primary[primaryKey].object.Value[0]}}</ng-container>
                                <ng-container *ngIf="_.hasIn(currentStudy.primary,[primaryKey,'object','Value',0,'Alphabetic']) && !_.isEmpty(currentStudy.primary[primaryKey].object.Value[0].Alphabetic)">{{currentStudy.primary[primaryKey].object.Value[0].Alphabetic}}</ng-container>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="checkbox_content" >
                    <md-checkbox *ngIf="groupName != 'missing'"  [ngModel]="selectedVersion === 'FIRST'" (ngModelChange)="changeSelectedVersion('FIRST')">{{selectLabel}}</md-checkbox>
                </div>
            </div>
            <div class="second_diff table_block" [ngClass]="{selected: selectedVersion === 'SECOND'}" *ngIf="groupName != 'missing'">
                <div class="header">
                    <h3>{{aet2}}</h3>
                </div>
                <div class="diff_content edytatabel"  (mouseenter)="setActiveTable('SECOND')" (mouseleave)="clearActiveTable()">
                    <table>
                        <tr *ngFor="let secondaryKey of currentStudyIndex" [ngClass]="{diff_line: currentStudy.secondary[secondaryKey].diff,active:activeTr === secondaryKey}" (mouseenter)="activateTr(secondaryKey)" (mouseleave)="clearTr()">
                            <td>{{currentStudy["level"][secondaryKey]}} {{DCM4CHE.elementName.forTag(secondaryKey,privateCreator(secondaryKey))}}</td>
                            <td>{{secondaryKey}}</td>
                            <td>
                                <ng-container *ngIf="_.hasIn(currentStudy.secondary,[secondaryKey,'object','Value',0]) && !_.hasIn(currentStudy.secondary,[secondaryKey,'object','Value',0,'Alphabetic'])">{{currentStudy.secondary[secondaryKey].object.Value[0]}}</ng-container>
                                <ng-container *ngIf="_.hasIn(currentStudy.secondary,[secondaryKey,'object','Value',0,'Alphabetic'])">{{currentStudy.secondary[secondaryKey].object.Value[0].Alphabetic}}</ng-container>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="checkbox_content">
                    <md-checkbox  [ngModel]="selectedVersion === 'SECOND'" (ngModelChange)="changeSelectedVersion('SECOND')">{{selectLabel}}</md-checkbox>
                </div>
            </div>
            <div class="queued">
                    <md-checkbox [(ngModel)]="queue">Queue the request(s)</md-checkbox>
            </div>
        </div>

        <div class="arrows">
            <a class="prev" [attr.disabled]="index === 0 ? true : null" (click)="$event.preventDefault();prepareStudyWithIndex(index-1)" title="Show previous diff"><span class="glyphicon glyphicon-chevron-left"></span> <span class="text">PREVIOUS</span></a>
<!--            <button class="queues">
                <label title="If checked the process will be queued">
                    <input type="checkbox" name="queue" [(ngModel)]="queue"> Queued request
                </label>
            </button>-->
            <button *ngIf="allAction" class="save" type="button" (click)="executeAllProcess(allAction)">{{allActionLabel}}</button>
            <button *ngIf="!allAction && groupName === 'missing'" class="save" type="button" (click)="executeProcess('missing')">{{buttonLabel}}</button>
            <button *ngIf="!allAction && groupName != 'missing' && actions.length < 2" title="{{(actions.length === 0 ? 'Coming soon...':'')}}" [disabled]="actions.length === 0" class="save" type="button" (click)="executeProcess(actions[0].key)">
                {{buttonLabel}}
            </button>
            <ul *ngIf="!allAction && actions.length > 1" class="actions">
                <li *ngFor="let action of actions" (click)="executeProcess(action.key)" title="{{action.description}}">{{action.label}}</li>
            </ul>
            <a class="next" [attr.disabled]="index === (studies.length-1) ? true : null" (click)="$event.preventDefault();prepareStudyWithIndex(index+1)" title="Show next diff"><span class="text">NEXT</span> <span class="glyphicon glyphicon-chevron-right"></span></a>
        </div>
        <div class="dialogbuttons">
            <button class="cancle" type="button" (click)="dialogRef.close(null)">CLOSE</button>

        </div>
    </div>
</div>